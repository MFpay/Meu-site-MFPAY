<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MFPAY | SYSTEM</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* CSS INTEGRADO */
        body { background: #050505; color: white; font-family: 'Inter', sans-serif; overflow-x: hidden; }
        .view { display: none; min-height: 100vh; flex-direction: column; }
        .active-view { display: flex; animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .glass-card { background: linear-gradient(145deg, #1a1a1a, #0a0a0a); border: 1px solid rgba(255,255,255,0.05); box-shadow: 0 10px 30px -10px rgba(0, 227, 140, 0.1); }
        .mf-input { background: #111; border: 1px solid #222; border-radius: 12px; padding: 15px; width: 100%; outline: none; color: white; font-size: 14px; transition: 0.3s; }
        .mf-input:focus { border-color: #00e38c; }
        .mf-btn { background: #00e38c; color: black; font-weight: 900; padding: 18px; border-radius: 12px; text-transform: uppercase; font-style: italic; cursor: pointer; border: none; width: 100%; font-size: 14px; margin-top: 10px; }
        
        .progress-container { width: 100%; background-color: #222; border-radius: 10px; overflow: hidden; height: 12px; margin-top: 8px; border: 1px solid #333; }
        .progress-bar { height: 100%; background: linear-gradient(90deg, #00e38c, #00ffaa); width: 0%; transition: width 1s ease-in-out; border-radius: 10px; box-shadow: 0 0 15px rgba(0, 227, 140, 0.5); }
        
        #loader { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 9999; flex-direction: column; align-items: center; justify-content: center; }
        .loader-spin { width: 50px; height: 50px; border: 5px solid #111; border-top: 5px solid #00e38c; border-radius: 50%; animation: spin 1s linear infinite; margin-bottom: 20px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <div id="loader">
        <div class="loader-spin"></div>
        <h2 class="text-[#00e38c] font-black text-sm uppercase tracking-widest">Carregando...</h2>
    </div>

    <section id="view-login" class="view active-view items-center justify-center p-6">
        <div class="w-full max-w-sm text-center">
            <h1 class="text-6xl font-black italic text-[#00e38c] mb-2 tracking-tighter">MFPAY</h1>
            <p class="text-zinc-500 text-[10px] uppercase mb-10 tracking-[0.2em]">Bank System v10.0</p>
            <div class="glass-card p-8 rounded-[30px]">
                <input type="email" id="log-email" placeholder="E-mail" class="mf-input mb-3">
                <input type="password" id="log-senha" placeholder="Senha" class="mf-input mb-6">
                <button onclick="fazerLogin()" class="mf-btn shadow-lg shadow-[#00e38c]/20">ENTRAR</button>
                <div class="mt-6 border-t border-white/5 pt-4">
                    <p class="text-zinc-500 text-[10px] mb-2">N√£o tem conta?</p>
                    <button onclick="trocarTela('view-cadastro')" class="text-[#00e38c] font-bold text-xs uppercase border border-[#00e38c] px-6 py-2 rounded-full hover:bg-[#00e38c] hover:text-black transition">CRIAR CONTA</button>
                </div>
            </div>
        </div>
    </section>

    <section id="view-cadastro" class="view items-center justify-center p-6">
        <div class="w-full max-w-sm text-center">
            <h1 class="text-4xl font-black italic text-[#00e38c] mb-8 uppercase">NOVA CONTA</h1>
            <div class="glass-card p-8 rounded-[30px] space-y-4">
                <input type="text" id="reg-nome" placeholder="Nome Completo" class="mf-input">
                <input type="email" id="reg-email" placeholder="Seu E-mail" class="mf-input">
                <input type="password" id="reg-senha" placeholder="Sua Senha" class="mf-input">
                <button onclick="fazerCadastro()" class="mf-btn">FINALIZAR</button>
                <button onclick="trocarTela('view-login')" class="text-zinc-500 text-[10px] uppercase font-bold mt-4 hover:text-white block w-full">Voltar</button>
            </div>
        </div>
    </section>

    <section id="view-dash" class="view">
        <nav class="p-6 flex justify-between items-center sticky top-0 z-50 bg-[#050505]/95 backdrop-blur border-b border-white/5">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-full bg-zinc-800 flex items-center justify-center border border-[#00e38c]/30 text-[#00e38c] font-black shadow-[0_0_10px_rgba(0,227,140,0.2)]">MF</div>
                <div>
                    <p class="text-[9px] text-zinc-500 uppercase font-bold">Bem-vindo,</p>
                    <h1 id="txt-user-nome" class="text-sm font-black italic text-white uppercase">...</h1>
                </div>
            </div>
            <button onclick="fazerLogout()" class="text-[10px] font-bold text-zinc-500 hover:text-white uppercase transition">Sair</button>
        </nav>
        
        <div id="box-aviso" class="hidden mx-6 mb-4 bg-yellow-500/10 border border-yellow-500/20 p-3 rounded-xl flex items-center gap-3 animate-pulse">
            <span class="text-lg">‚ö†Ô∏è</span>
            <p id="txt-aviso" class="text-[10px] text-yellow-500 font-bold uppercase">Aviso</p>
        </div>

        <main class="px-6 pb-20 max-w-md mx-auto w-full space-y-6">
            <div class="glass-card p-6 rounded-[25px] relative overflow-hidden">
                <div class="absolute top-0 right-0 w-40 h-40 bg-[#00e38c] blur-[90px] opacity-10"></div>
                <div class="flex justify-between items-start mb-6">
                    <p class="text-[10px] font-black uppercase text-zinc-400 tracking-widest">Saldo Dispon√≠vel</p>
                    <span class="text-[9px] font-black text-[#00e38c] border border-[#00e38c]/30 px-2 py-1 rounded bg-[#00e38c]/10">ONLINE</span>
                </div>
                <h2 id="user-saldo" class="text-4xl font-black italic text-white mb-2 tracking-tighter">R$ 0,00</h2>
            </div>

            <div class="glass-card p-5 rounded-[20px] border border-[#00e38c]/20 relative overflow-hidden">
                <div class="absolute inset-0 bg-gradient-to-r from-transparent via-[#00e38c]/5 to-transparent opacity-50"></div>
                <div class="flex justify-between items-center mb-2 relative z-10">
                    <h3 class="text-[10px] font-black uppercase text-[#00e38c] italic flex items-center gap-2"><span>üéØ</span> Meta 10K</h3>
                    <span id="meta-txt" class="text-[10px] font-bold text-white bg-black/50 px-2 py-1 rounded">0%</span>
                </div>
                <div class="progress-container relative z-10"><div id="meta-bar" class="progress-bar"></div></div>
                <p id="meta-desc" class="text-[10px] text-zinc-400 mt-3 text-center relative z-10 font-medium">Faltam <b class="text-white">R$ 10k</b> para a Pulseira.</p>
            </div>

            <div class="grid grid-cols-2 gap-3">
                <button onclick="trocarTela('view-checkout')" class="glass-card p-4 rounded-2xl flex flex-col items-center gap-2 hover:bg-zinc-900 transition group">
                    <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center text-black font-black text-xl group-hover:scale-110 transition">‚Üì</div>
                    <span class="text-[10px] font-black uppercase group-hover:text-[#00e38c] transition">Depositar</span>
                </button>
                <button onclick="trocarTela('view-saque')" class="glass-card p-4 rounded-2xl flex flex-col items-center gap-2 hover:bg-zinc-900 transition group">
                    <div class="w-10 h-10 bg-zinc-800 rounded-full flex items-center justify-center text-white border border-white/10 font-black text-xl group-hover:scale-110 transition">‚Üë</div>
                    <span class="text-[10px] font-black uppercase group-hover:text-[#00e38c] transition">Sacar</span>
                </button>
            </div>
        </main>
    </section>

    <section id="view-admin" class="view">
        <nav class="p-6 bg-[#00e38c] text-black font-black flex justify-between items-center shadow-lg sticky top-0 z-50">
            <span>ADMIN PRO</span>
            <button onclick="fazerLogout()" class="text-[9px] uppercase bg-black text-white px-3 py-1 rounded hover:bg-zinc-800 transition">Sair</button>
        </nav>
        <main class="p-4 space-y-4 max-w-lg mx-auto w-full overflow-y-auto pb-20">
            <div class="bg-[#111] border border-zinc-800 rounded-[20px] p-4">
                <div class="flex justify-between items-center mb-4">
                    <p class="text-[10px] font-black uppercase text-yellow-500 italic">üîî Pendentes</p>
                    <button onclick="carregarAdminData()" class="text-[8px] bg-zinc-800 text-white px-2 py-1 rounded">‚Üª</button>
                </div>
                <div id="lista-pedidos" class="space-y-2"><p class="text-[9px] text-zinc-600 text-center">Nada.</p></div>
            </div>
            <div class="bg-[#111] border border-zinc-800 rounded-[20px] p-4">
                <p class="text-[10px] font-black uppercase text-[#00e38c] italic mb-4">üë• Clientes (<span id="total-users">0</span>)</p>
                <div id="lista-users" class="space-y-2 max-h-40 overflow-y-auto pr-1"></div>
            </div>
            <div class="bg-[#111] border border-zinc-800 rounded-[20px] p-4">
                <p class="text-[10px] font-black uppercase text-purple-500 italic mb-2">üì¢ Aviso</p>
                <div class="flex gap-2">
                    <input type="text" id="adm-aviso-txt" placeholder="Mensagem..." class="mf-input">
                    <button onclick="postarAviso()" class="bg-purple-600 text-white font-bold px-4 rounded-xl text-[10px]">ENVIAR</button>
                </div>
                <button onclick="limparAviso()" class="text-[8px] text-zinc-500 mt-2 w-full text-right uppercase hover:text-white">Limpar</button>
            </div>
            <div class="bg-[#111] border border-zinc-800 rounded-[20px] p-4">
                <p class="text-[10px] font-black uppercase text-blue-500 italic mb-2">üí∏ Editar Saldo</p>
                <input type="text" id="edit-email" placeholder="E-mail" class="mf-input mb-2">
                <div class="flex gap-2">
                    <input type="number" id="edit-val" placeholder="Valor" class="mf-input">
                    <button onclick="alterarSaldoManual(true)" class="bg-green-600 text-white font-bold px-3 rounded-xl text-[10px] w-1/3 hover:bg-green-500">+</button>
                    <button onclick="alterarSaldoManual(false)" class="bg-red-600 text-white font-bold px-3 rounded-xl text-[10px] w-1/3 hover:bg-red-500">-</button>
                </div>
            </div>
        </main>
    </section>

    <section id="view-checkout" class="view bg-[#f3f4f6] text-black">
        <nav class="bg-white p-5 flex justify-between items-center border-b border-gray-200 sticky top-0">
            <h1 class="text-xl font-black italic text-[#00e38c]">MFPAY</h1>
            <button onclick="trocarTela('view-dash')" class="text-xs font-bold text-gray-400 hover:text-black">VOLTAR</button>
        </nav>
        <main class="p-6 max-w-md mx-auto w-full space-y-4">
            <div class="bg-white p-8 rounded-3xl shadow-sm border border-gray-100 text-center">
                <p class="text-[10px] text-gray-400 font-bold uppercase mb-4">Dep√≥sito PIX</p>
                <h3 class="text-xs font-black break-all select-all mb-4 bg-gray-100 p-3 rounded-xl border border-gray-200">contaprajogoplaystaicion@gmail.com</h3>
                <input type="number" id="v-pix" placeholder="Valor (R$)" class="w-full p-4 bg-gray-50 border border-gray-200 rounded-xl text-center font-black text-xl mb-4 outline-none focus:border-[#00e38c] transition">
                <button onclick="gerarOrdem()" class="w-full mf-btn text-white shadow-lg shadow-[#00e38c]/20">Enviar Comprovante</button>
            </div>
        </main>
    </section>

    <section id="view-saque" class="view">
        <nav class="p-8 border-b border-white/5"><h1 class="text-xl font-black italic text-[#00e38c]">SAQUE</h1></nav>
        <main class="p-6 max-w-md mx-auto w-full space-y-4">
            <div class="glass-card p-6 rounded-[20px]">
                <label class="text-[9px] text-zinc-500 font-bold uppercase block mb-2">Chave PIX</label>
                <input type="text" id="pix-saque" placeholder="CPF/Email" class="mf-input mb-4">
                <label class="text-[9px] text-zinc-500 font-bold uppercase block mb-2">Valor</label>
                <input type="number" id="val-saque" placeholder="R$ 0,00" class="mf-input text-[#00e38c] font-black text-lg">
            </div>
            <button onclick="pedirSaque()" class="mf-btn w-full">Confirmar</button>
            <button onclick="trocarTela('view-dash')" class="w-full text-zinc-600 font-bold text-[10px] uppercase py-2 hover:text-white">Cancelar</button>
        </main>
    </section>

    <script>
        const CONFIG = { BIN: "6990a515d0ea881f40ba65eb", KEY: "$2a$10$BH1hrj8d.ptln54HlH7u/Oo2rbwnadiFrQZDHfXHEOSy2nwtswFMG" };
        const URL = `https://api.jsonbin.io/v3/b/${CONFIG.BIN}`;
        let currentUser = null;

        function trocarTela(id) {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active-view'));
            document.getElementById(id).classList.add('active-view');
            window.scrollTo(0,0);
        }

        async function api(method, body = null) {
            document.getElementById('loader').style.display = 'flex';
            try {
                const r = await fetch(URL, { method, headers: { "X-Master-Key": CONFIG.KEY, "Content-Type": "application/json", "X-Bin-Meta": "false" }, body: body ? JSON.stringify(body) : null });
                const d = await r.json();
                document.getElementById('loader').style.display = 'none';
                return d;
            } catch (e) { document.getElementById('loader').style.display = 'none'; return null; }
        }

        // CADASTRO
        async function fazerCadastro() {
            const n = document.getElementById('reg-nome').value.trim();
            const e = document.getElementById('reg-email').value.trim().toLowerCase();
            const s = document.getElementById('reg-senha').value;
            if(!n || !e || !s) return alert("Preencha tudo!");

            let db = await api("GET");
            if(!db || !db.usuarios) db = { usuarios: {}, notificacoes: [], config: { aviso: "" } };

            if(db.usuarios[e]) return alert("Conta j√° existe! Fa√ßa login.");

            db.usuarios[e] = { nome: n, pin: s, saldo: 0 };
            await api("PUT", db);
            alert("Sucesso! Agora fa√ßa Login.");
            trocarTela('view-login');
        }

        // LOGIN
        async function fazerLogin() {
            const e = document.getElementById('log-email').value.trim().toLowerCase();
            const s = document.getElementById('log-senha').value;
            if(!e || !s) return alert("Preencha e-mail e senha.");

            if(e === "contaprajogoplaystaicion@gmail.com" && s === "admin123") {
                trocarTela('view-admin'); carregarAdminData(); return;
            }

            let db = await api("GET");
            if(!db || !db.usuarios) db = { usuarios: {}, notificacoes: [], config: { aviso: "" } };

            if(db.usuarios[e] && db.usuarios[e].pin === s) {
                currentUser = e;
                entrarDash(db);
            } else {
                alert("E-mail ou senha errados!");
            }
        }

        function entrarDash(db) {
            const user = db.usuarios[currentUser];
            document.getElementById('txt-user-nome').innerText = user.nome || "Cliente";
            document.getElementById('user-saldo').innerText = `R$ ${user.saldo.toFixed(2)}`;
            
            const meta = 10000;
            let percent = (user.saldo / meta) * 100; if(percent > 100) percent = 100;
            document.getElementById('meta-bar').style.width = `${percent}%`;
            document.getElementById('meta-txt').innerText = `${percent.toFixed(1)}%`;
            
            if(user.saldo >= meta) document.getElementById('meta-desc').innerHTML = `<b class="text-[#00e38c] animate-pulse">PULSEIRA VIP LIBERADA!</b>`;
            else document.getElementById('meta-desc').innerHTML = `Faltam <b class="text-white">R$ ${(meta - user.saldo).toFixed(2)}</b>`;

            if(db.config && db.config.aviso) {
                document.getElementById('box-aviso').classList.remove('hidden');
                document.getElementById('txt-aviso').innerText = db.config.aviso;
            } else document.getElementById('box-aviso').classList.add('hidden');
            
            trocarTela('view-dash');
            setInterval(syncSaldo, 10000);
        }

        function fazerLogout() {
            currentUser = null;
            document.getElementById('log-email').value = "";
            document.getElementById('log-senha').value = "";
            trocarTela('view-login');
        }

        async function syncSaldo() {
            if(!currentUser) return;
            const db = await api("GET");
            if(db.usuarios[currentUser]) {
                const s = db.usuarios[currentUser].saldo;
                document.getElementById('user-saldo').innerText = `R$ ${s.toFixed(2)}`;
                let p = (s / 10000) * 100; if(p > 100) p = 100;
                document.getElementById('meta-bar').style.width = `${p}%`;
                document.getElementById('meta-txt').innerText = `${p.toFixed(1)}%`;
            }
        }

        async function carregarAdminData() {
            let db = await api("GET"); if(!db) return;
            const lp = document.getElementById('lista-pedidos');
            if(!db.notificacoes || db.notificacoes.length === 0) lp.innerHTML = '<p class="text-[9px] text-zinc-600 text-center">Nada.</p>';
            else lp.innerHTML = db.notificacoes.map(n => `<div class="flex justify-between items-center bg-zinc-900 p-2 rounded mb-1 border border-zinc-800"><span class="text-[9px] text-zinc-400">${n.email} <b class="text-[#00e38c]">R$ ${n.valor}</b></span><button onclick="aprovar('${n.id}', '${n.email}', ${n.valor})" class="bg-[#00e38c] text-black text-[8px] font-bold px-2 py-1 rounded">OK</button></div>`).join('');
            const lu = document.getElementById('lista-users');
            const u = Object.keys(db.usuarios);
            document.getElementById('total-users').innerText = u.length;
            lu.innerHTML = u.map(x => `<div class="flex justify-between items-center bg-zinc-900 p-2 rounded mb-1 border border-zinc-800"><span class="text-[9px] text-zinc-400 truncate w-32">${x}</span><span class="text-[9px] font-bold text-white">R$ ${db.usuarios[x].saldo.toFixed(2)}</span><button onclick="copiarEmail('${x}')" class="text-[8px] bg-zinc-700 px-1 rounded text-zinc-300">Copy</button></div>`).join('');
        }
        async function aprovar(id, email, valor) { let db = await api("GET"); db.usuarios[email].saldo += valor; db.notificacoes = db.notificacoes.filter(n => n.id != id); await api("PUT", db); alert("Aprovado!"); carregarAdminData(); }
        function copiarEmail(e) { document.getElementById('edit-email').value = e; }
        async function alterarSaldoManual(somar) { const email = document.getElementById('edit-email').value.trim(); const val = parseFloat(document.getElementById('edit-val').value); if(!email || !val) return; let db = await api("GET"); if(!db.usuarios[email]) return; if(somar) db.usuarios[email].saldo += val; else db.usuarios[email].saldo -= val; await api("PUT", db)
