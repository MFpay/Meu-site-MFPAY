<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>MF PAY | MASTER CONTROL</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body { background: #050505; color: #f1f5f9; font-family: 'Inter', sans-serif; }
        .sidebar { background: #0a0a0a; border-right: 1px solid #1a1a1a; height: 100vh; position: fixed; width: 260px; display: none; }
        .main-content { margin-left: 260px; padding: 40px; display: none; }
        .admin-card { background: #0f0f0f; border: 1px solid #1e293b; border-radius: 16px; }
        .nav-btn { width: 100%; text-align: left; padding: 15px 25px; font-size: 11px; font-weight: 800; text-transform: uppercase; color: #444; transition: 0.3s; border-left: 4px solid transparent; italic; }
        .nav-btn.active { color: #80ff44; background: #111; border-left-color: #80ff44; }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        /* Estilo Login */
        #login-screen { height: 100vh; display: flex; align-items: center; justify-content: center; background: #000; }
        .login-box { background: #0a0a0a; padding: 40px; border-radius: 24px; border: 1px solid #1a1a1a; width: 100%; max-width: 400px; text-align: center; }
        input { background: #111 !important; border: 1px solid #222 !important; color: #fff; padding: 15px; border-radius: 12px; width: 100%; outline: none; margin-bottom: 15px; }
        .neon-text { color: #80ff44; }
    </style>
</head>
<body>

    <div id="login-screen">
        <div class="login-box">
            <h1 class="text-2xl font-black italic neon-text mb-8 uppercase tracking-tighter">MF PAY <span class="text-white">MASTER</span></h1>
            <input type="text" id="adm-user" placeholder="Usuário Master">
            <input type="password" id="adm-pass" placeholder="Senha de Acesso">
            <button onclick="autenticar()" class="w-full bg-[#80ff44] text-black font-black py-4 rounded-xl uppercase italic hover:scale-105 transition">Entrar no Sistema</button>
            <p id="login-err" class="text-red-500 text-[10px] mt-4 font-bold uppercase hidden">Acesso Negado: Credenciais Inválidas</p>
        </div>
    </div>

    <aside id="sidebar" class="sidebar py-10 flex flex-col justify-between">
        <div>
            <div class="px-8 mb-10 text-center">
                <h1 class="text-xl font-black italic neon-text uppercase tracking-tighter">ADMIN <span class="text-white">MASTER</span></h1>
            </div>
            <nav class="space-y-1">
                <button onclick="openTab(event, 'fila')" class="nav-btn active">Fila de Pedidos</button>
                <button onclick="openTab(event, 'mensagens')" class="nav-btn">Mensagens</button>
                <button onclick="openTab(event, 'config')" class="nav-btn">Configurações</button>
            </nav>
        </div>
        <div class="px-8">
             <button onclick="toggleLockdown()" id="lockBtn" class="w-full py-3 rounded-xl font-black text-[10px] uppercase italic transition-all"></button>
             <button onclick="logout()" class="w-full text-gray-600 text-[9px] font-bold uppercase mt-4 hover:text-white">Sair do Sistema</button>
        </div>
    </aside>

    <main id="main-content" class="main-content">
        
        <div id="fila" class="tab-content active">
            <h2 class="text-3xl font-black italic uppercase mb-8">Pedidos de Liquidação</h2>
            <div class="admin-card overflow-hidden">
                <table class="w-full text-left">
                    <thead class="bg-[#111] text-[10px] font-black uppercase text-gray-500">
                        <tr>
                            <th class="p-5">User</th>
                            <th class="p-5">Tipo</th>
                            <th class="p-5">Valor</th>
                            <th class="p-5">Ações</th>
                        </tr>
                    </thead>
                    <tbody id="lista-pedidos"></tbody>
                </table>
            </div>
        </div>

        <div id="mensagens" class="tab-content">
            <h2 class="text-3xl font-black italic uppercase mb-8">Suporte Recebido</h2>
            <div id="lista-mensagens" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
        </div>

        <div id="config" class="tab-content">
            <h2 class="text-3xl font-black italic uppercase mb-8">Configurações Globais</h2>
            <div class="admin-card p-8 max-w-xl">
                <label class="text-[10px] font-bold text-gray-500 uppercase block mb-2 italic">Chave Pix Master (Recebimento)</label>
                <input type="text" id="master-pix-input">
                <button onclick="salvarPix()" class="w-full bg-[#80ff44] text-black font-black py-4 rounded-xl uppercase italic">Salvar Alterações</button>
            </div>
        </div>
    </main>

<script>
    // CONFIGURAÇÃO DE LOGIN
    function autenticar() {
        const u = document.getElementById('adm-user').value;
        const p = document.getElementById('adm-pass').value;

        // Login padrão: admin / mestre123
        if(u === 'admin' && p === 'mestre123') {
            sessionStorage.setItem('adm_logado', 'true');
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('sidebar').style.display = 'flex';
            document.getElementById('main-content').style.display = 'block';
            renderPedidos();
        } else {
            document.getElementById('login-err').classList.remove('hidden');
        }
    }

    function logout() {
        sessionStorage.removeItem('adm_logado');
        location.reload();
    }

    function openTab(evt, tabName) {
        let i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tab-content");
        for (i = 0; i < tabcontent.length; i++) { tabcontent[i].style.display = "none"; }
        tablinks = document.getElementsByClassName("nav-btn");
        for (i = 0; i < tablinks.length; i++) { tablinks[i].className = tablinks[i].className.replace(" active", ""); }
        document.getElementById(tabName).style.display = "block";
        evt.currentTarget.className += " active";
    }

    function toggleLockdown() {
        const s = localStorage.getItem('mf_lockdown') === 'true';
        localStorage.setItem('mf_lockdown', !s);
        updateLockBtn(!s);
    }

    function updateLockBtn(s) {
        const b = document.getElementById('lockBtn');
        b.innerText = s ? "SISTEMA TRAVADO" : "SISTEMA LIBERADO";
        b.style.background = s ? "#ef4444" : "#1a1a1a";
        b.style.color = s ? "#fff" : "#888";
    }

    function salvarPix() {
        localStorage.setItem('mf_pix', document.getElementById('master-pix-input').value);
        alert("PIX ATUALIZADO!");
    }

    function renderPedidos() {
        const lista = document.getElementById('lista-pedidos');
        const ped = JSON.parse(localStorage.getItem('mf_ped'));
        lista.innerHTML = '';
        if(!ped) return;
        
        lista.innerHTML = `
            <tr class="border-t border-white/5">
                <td class="p-5 font-bold italic">${ped.user}</td>
                <td class="p-5 text-[10px] font-black">${ped.tipo}</td>
                <td class="p-5 text-[#80ff44] font-black">R$ ${ped.valor}</td>
                <td class="p-5">
                    <button onclick="decidir('APR')" class="bg-[#80ff44] text-black text-[9px] font-black px-3 py-1 rounded">Aprovar</button>
                    <button onclick="decidir('REC')" class="bg-red-500 text-white text-[9px] font-black px-3 py-1 rounded">Negar</button>
                </td>
            </tr>
        `;
    }

    function decidir(acao) {
        const ped = JSON.parse(localStorage.getItem('mf_ped'));
        if(acao === 'APR') {
            const current = parseFloat(localStorage.getItem('bal_'+ped.user) || 0);
            const val = parseFloat(ped.valor);
            localStorage.setItem('bal_'+ped.user, ped.tipo === 'DEP' ? (current + val) : (current - val));
        }
        localStorage.removeItem('mf_ped');
        renderPedidos();
    }

    // Loop de Atualização
    setInterval(() => {
        if(sessionStorage.getItem('adm_logado') === 'true') {
            renderPedidos();
            updateLockBtn(localStorage.getItem('mf_lockdown') === 'true');
        }
    }, 2000);

    // Carregar chave atual
    document.getElementById('master-pix-input').value = localStorage.getItem('mf_pix') || '';
</script>
</body>
</html>
