<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Master Radar | MFpay</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-black text-white p-6 md:p-12 font-sans">
    <div class="flex flex-col md:flex-row justify-between items-center mb-16 gap-6">
        <div>
            <h1 class="text-5xl font-black italic text-[#80ff44]">MASTER RADAR</h1>
            <p class="text-[10px] opacity-20 uppercase font-black tracking-[0.5em]">Vigilância Soberana</p>
        </div>
        <div class="bg-[#0a0a0a] p-6 rounded-3xl border border-white/5 flex gap-4">
            <input type="text" id="nw" placeholder="Nome Marca" class="bg-black border border-white/10 p-2 rounded text-xs outline-none focus:border-[#80ff44]">
            <input type="color" id="nc" class="bg-transparent border-none w-10 h-10 cursor-pointer">
            <button onclick="saveWL()" class="bg-white text-black px-6 rounded-xl font-black text-[10px] uppercase">Salvar Marca</button>
            <button onclick="panic()" class="bg-red-600 text-white px-6 rounded-xl font-black text-[10px] uppercase">Pânico</button>
        </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-12">
        <div class="bg-[#0a0a0a] p-12 rounded-[50px] border-l-8 border-[#80ff44] shadow-2xl">
            <p class="text-[10px] opacity-40 font-black mb-2 uppercase tracking-widest">Faturamento Global</p>
            <h2 id="fat" class="text-6xl font-black italic">R$ 0,00</h2>
        </div>
    </div>

    <div id="fila" class="grid grid-cols-1 lg:grid-cols-2 gap-8"></div>

    <div id="view" onclick="this.style.display='none'" class="fixed inset-0 bg-black/95 hidden flex items-center justify-center p-10 z-50">
        <img id="img-full" src="" class="max-w-full max-h-full rounded-2xl shadow-2xl border border-white/10">
    </div>

    <script>
        const API = 'https://sheetdb.io/api/v1/n1iq28pv28d009pq';

        function saveWL() { localStorage.setItem('mf_white_label', JSON.stringify({nome: document.getElementById('nw').value || 'MFpay', cor: document.getElementById('nc').value})); location.reload(); }
        function panic() { const s = localStorage.getItem('mf_panico') === 'true'; localStorage.setItem('mf_panico', !s); alert(!s ? "REDE BLOQUEADA!" : "REDE LIBERADA!"); }

        async function monitorar() {
            try {
                const res = await fetch(API); const d = await res.json();
                const faturamento = d.filter(i => i.status === 'Aprovado' && i.tipo === 'DEPOSITO').reduce((a, b) => a + parseFloat(b.valor || 0), 0);
                document.getElementById('fat').innerText = `R$ ${faturamento.toLocaleString('pt-BR')}`;
                
                const pendentes = d.filter(i => i.status === 'Pendente');
                document.getElementById('fila').innerHTML = pendentes.map(p => `
                    <div class="bg-[#0a0a0a] p-10 rounded-[40px] border border-white/5 flex justify-between items-center shadow-xl">
                        <div>
                            <p class="text-[9px] font-black text-[#80ff44] uppercase mb-1">${p.merchant} | ${p.tipo}</p>
                            <h3 class="text-3xl font-black italic">R$ ${p.valor}</h3>
                            ${p.comprovante ? `<button onclick="ver('${p.comprovante}')" class="text-blue-400 text-[10px] font-bold underline uppercase">Ver Foto</button>` : `<p class='text-[9px] opacity-40 mt-1'>PIX: ${p.chave_pix}</p>`}
                        </div>
                        <button onclick="aprovar('${p.id}')" class="bg-white text-black px-10 py-4 rounded-2xl font-black text-xs uppercase hover:bg-[#80ff44] transition-all">Aprovar</button>
                    </div>
                `).join('');
            } catch(e) { console.error("Erro de conexão com API."); }
        }

        function ver(img) { document.getElementById('img-full').src = img; document.getElementById('view').style.display = 'flex'; }
        async function aprovar(id) { await fetch(`${API}/id/${id}`, { method: 'PATCH', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ data: { status: 'Aprovado' } }) }); monitorar(); }
        
        setInterval(monitorar, 8000); monitorar();
    </script>
</body>
</html>
