<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Master Radar | MFpay</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-black text-white p-10 font-sans">
    <div class="flex justify-between items-center mb-16">
        <h1 class="text-4xl font-black italic text-[#80ff44]">MASTER RADAR</h1>
        <button onclick="saveWL()" class="bg-white text-black px-6 py-2 rounded-xl text-[10px] font-black uppercase">Configurar White Label</button>
    </div>

    <div id="fila" class="grid grid-cols-1 md:grid-cols-2 gap-8"></div>

    <div id="modal" onclick="this.style.display='none'" class="fixed inset-0 bg-black/90 hidden z-50 flex items-center justify-center p-10">
        <img id="img-full" src="" class="max-w-full max-h-full rounded-2xl border border-white/10">
    </div>

    <script>
        const API = 'https://sheetdb.io/api/v1/q28pv28d009pq';

        async function carregar() {
            const res = await fetch(API);
            const dados = await res.json();
            const pendentes = dados.filter(i => i.status === 'Pendente');

            document.getElementById('fila').innerHTML = pendentes.map(p => `
                <div class="bg-[#0a0a0a] p-10 rounded-[40px] border border-white/5 flex justify-between items-center">
                    <div>
                        <p class="text-[9px] font-black text-[#80ff44] uppercase mb-1">${p.merchant}</p>
                        <h3 class="text-3xl font-black italic">R$ ${p.valor}</h3>
                        <button onclick="verFoto('${p.comprovante}')" class="text-[10px] text-blue-400 font-bold uppercase underline">Ver Comprovante</button>
                    </div>
                    <button onclick="decidir('${p.id}', 'Aprovado')" class="bg-white text-black px-8 py-3 rounded-2xl font-black text-xs uppercase italic">Aprovar</button>
                </div>
            `).join('');
        }

        function verFoto(src) {
            document.getElementById('img-full').src = src;
            document.getElementById('modal').style.display = 'flex';
        }

        async function decidir(id, st) {
            await fetch(`${API}/id/${id}`, {
                method: 'PATCH',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ data: { status: st } })
            });
            carregar();
        }

        carregar();
        setInterval(carregar, 10000);
    </script>
</body>
</html>
